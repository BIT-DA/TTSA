file name: train_TTSA_noMI_lr
PTL.version = 7.2.0
torch.version = 1.7.0+cu110
torchvision.version = 0.8.1+cu110
arch = resnet50
batch_size = 32
data_dir = /data1/TL/data/PACS/kfold/
dset = PACS
target_domain = cartoon
gpu = 1
output_dir = log/TTSA_for_DG/PACS/resnet50
epochs = 50
print_freq = 100
lr = 0.015
schdule_gamma = 1.0
decay_rate = 0.75
momentum = 0.9
weight_decay = 0.001
bottleneck_dim = 256
alpha = 0.1
lambda0 = 0.25
eta = 0.5
gamma = 0.001
beta = 0.1
seed = 0
Epoch: [00][100/429]	total_loss:0.424  loss_aug:0.350    loss_pro:73.975
Epoch: [00][200/429]	total_loss:0.324  loss_aug:0.244    loss_pro:79.975
Epoch = 00,  current_test_acc=72.824, best_test_acc = 72.824
Epoch: [01][300/429]	total_loss:0.140  loss_aug:0.079    loss_pro:61.006
Epoch: [01][400/429]	total_loss:0.117  loss_aug:0.081    loss_pro:36.111
Epoch = 01,  current_test_acc=78.754, best_test_acc = 78.754
Epoch: [02][500/429]	total_loss:0.280  loss_aug:0.203    loss_pro:76.533
Epoch: [02][600/429]	total_loss:0.120  loss_aug:0.071    loss_pro:49.119
Epoch = 02,  current_test_acc=76.834, best_test_acc = 78.754
Epoch: [03][700/429]	total_loss:0.067  loss_aug:0.022    loss_pro:45.314
Epoch: [03][800/429]	total_loss:0.185  loss_aug:0.134    loss_pro:50.789
Epoch = 03,  current_test_acc=80.290, best_test_acc = 80.290
Epoch: [04][900/429]	total_loss:0.105  loss_aug:0.042    loss_pro:62.933
Epoch: [04][1000/429]	total_loss:0.090  loss_aug:0.052    loss_pro:37.955
Epoch = 04,  current_test_acc=78.882, best_test_acc = 80.290
Epoch: [05][1100/429]	total_loss:0.113  loss_aug:0.074    loss_pro:38.977
Epoch: [05][1200/429]	total_loss:0.037  loss_aug:0.006    loss_pro:31.646
Epoch = 05,  current_test_acc=79.010, best_test_acc = 80.290
Epoch: [06][1300/429]	total_loss:0.061  loss_aug:0.018    loss_pro:42.487
Epoch: [06][1400/429]	total_loss:0.070  loss_aug:0.035    loss_pro:35.433
Epoch = 06,  current_test_acc=79.309, best_test_acc = 80.290
Epoch: [07][1500/429]	total_loss:0.103  loss_aug:0.062    loss_pro:41.409
Epoch: [07][1600/429]	total_loss:0.031  loss_aug:0.007    loss_pro:23.772
Epoch: [07][1700/429]	total_loss:0.044  loss_aug:0.006    loss_pro:37.495
Epoch = 07,  current_test_acc=79.650, best_test_acc = 80.290
Epoch: [08][1800/429]	total_loss:0.026  loss_aug:0.008    loss_pro:17.892
Epoch: [08][1900/429]	total_loss:0.078  loss_aug:0.055    loss_pro:23.569
Epoch = 08,  current_test_acc=79.096, best_test_acc = 80.290
Epoch: [09][2000/429]	total_loss:0.036  loss_aug:0.010    loss_pro:26.403
Epoch: [09][2100/429]	total_loss:0.154  loss_aug:0.118    loss_pro:35.952
Epoch = 09,  current_test_acc=80.119, best_test_acc = 80.290
Epoch: [10][2200/429]	total_loss:0.043  loss_aug:0.015    loss_pro:27.889
Epoch: [10][2300/429]	total_loss:0.051  loss_aug:0.027    loss_pro:23.842
Epoch = 10,  current_test_acc=78.882, best_test_acc = 80.290
Epoch: [11][2400/429]	total_loss:0.051  loss_aug:0.015    loss_pro:36.491
Epoch: [11][2500/429]	total_loss:0.080  loss_aug:0.045    loss_pro:34.590
Epoch = 11,  current_test_acc=81.869, best_test_acc = 81.869
Epoch: [12][2600/429]	total_loss:0.049  loss_aug:0.023    loss_pro:25.666
Epoch: [12][2700/429]	total_loss:0.039  loss_aug:0.012    loss_pro:26.677
Epoch = 12,  current_test_acc=80.546, best_test_acc = 81.869
Epoch: [13][2800/429]	total_loss:0.043  loss_aug:0.014    loss_pro:29.233
Epoch: [13][2900/429]	total_loss:0.048  loss_aug:0.017    loss_pro:31.229
Epoch = 13,  current_test_acc=80.247, best_test_acc = 81.869
Epoch: [14][3000/429]	total_loss:0.062  loss_aug:0.034    loss_pro:28.400
Epoch: [14][3100/429]	total_loss:0.035  loss_aug:0.009    loss_pro:25.340
Epoch: [14][3200/429]	total_loss:0.063  loss_aug:0.026    loss_pro:37.012
Epoch = 14,  current_test_acc=79.821, best_test_acc = 81.869
Epoch: [15][3300/429]	total_loss:0.053  loss_aug:0.033    loss_pro:19.629
Epoch: [15][3400/429]	total_loss:0.024  loss_aug:0.011    loss_pro:13.370
Epoch = 15,  current_test_acc=80.461, best_test_acc = 81.869
Epoch: [16][3500/429]	total_loss:0.044  loss_aug:0.020    loss_pro:23.805
Epoch: [16][3600/429]	total_loss:0.040  loss_aug:0.021    loss_pro:19.226
Epoch = 16,  current_test_acc=80.930, best_test_acc = 81.869
Epoch: [17][3700/429]	total_loss:0.025  loss_aug:0.010    loss_pro:15.140
Epoch: [17][3800/429]	total_loss:0.056  loss_aug:0.031    loss_pro:25.187
Epoch = 17,  current_test_acc=79.522, best_test_acc = 81.869
Epoch: [18][3900/429]	total_loss:0.024  loss_aug:0.011    loss_pro:12.520
Epoch: [18][4000/429]	total_loss:0.038  loss_aug:0.017    loss_pro:21.080
Epoch = 18,  current_test_acc=80.077, best_test_acc = 81.869
Epoch: [19][4100/429]	total_loss:0.030  loss_aug:0.010    loss_pro:20.195
Epoch: [19][4200/429]	total_loss:0.040  loss_aug:0.020    loss_pro:20.106
Epoch = 19,  current_test_acc=82.125, best_test_acc = 82.125
Epoch: [20][4300/429]	total_loss:0.030  loss_aug:0.015    loss_pro:15.140
Epoch: [20][4400/429]	total_loss:0.048  loss_aug:0.028    loss_pro:20.036
Epoch = 20,  current_test_acc=81.869, best_test_acc = 82.125
Epoch: [21][4500/429]	total_loss:0.048  loss_aug:0.016    loss_pro:32.547
Epoch: [21][4600/429]	total_loss:0.059  loss_aug:0.030    loss_pro:29.124
Epoch: [21][4700/429]	total_loss:0.045  loss_aug:0.020    loss_pro:25.369
Epoch = 21,  current_test_acc=82.722, best_test_acc = 82.722
Epoch: [22][4800/429]	total_loss:0.039  loss_aug:0.016    loss_pro:22.782
Epoch: [22][4900/429]	total_loss:0.025  loss_aug:0.010    loss_pro:14.240
Epoch = 22,  current_test_acc=81.783, best_test_acc = 82.722
Epoch: [23][5000/429]	total_loss:0.018  loss_aug:0.009    loss_pro:9.240
Epoch: [23][5100/429]	total_loss:0.036  loss_aug:0.016    loss_pro:20.202
Epoch = 23,  current_test_acc=81.869, best_test_acc = 82.722
Epoch: [24][5200/429]	total_loss:0.045  loss_aug:0.019    loss_pro:26.583
Epoch: [24][5300/429]	total_loss:0.039  loss_aug:0.025    loss_pro:14.054
Epoch = 24,  current_test_acc=83.063, best_test_acc = 83.063
Epoch: [25][5400/429]	total_loss:0.030  loss_aug:0.011    loss_pro:18.101
Epoch: [25][5500/429]	total_loss:0.040  loss_aug:0.015    loss_pro:24.173
Epoch = 25,  current_test_acc=84.599, best_test_acc = 84.599
Epoch: [26][5600/429]	total_loss:0.016  loss_aug:0.008    loss_pro:8.530
Epoch: [26][5700/429]	total_loss:0.040  loss_aug:0.027    loss_pro:13.577
Epoch = 26,  current_test_acc=82.935, best_test_acc = 84.599
Epoch: [27][5800/429]	total_loss:0.027  loss_aug:0.010    loss_pro:17.523
Epoch: [27][5900/429]	total_loss:0.044  loss_aug:0.017    loss_pro:27.158
Epoch = 27,  current_test_acc=82.594, best_test_acc = 84.599
Epoch: [28][6000/429]	total_loss:0.038  loss_aug:0.019    loss_pro:18.827
Epoch: [28][6100/429]	total_loss:0.037  loss_aug:0.016    loss_pro:20.490
Epoch: [28][6200/429]	total_loss:0.030  loss_aug:0.013    loss_pro:17.450
Epoch = 28,  current_test_acc=83.788, best_test_acc = 84.599
Epoch: [29][6300/429]	total_loss:0.034  loss_aug:0.016    loss_pro:17.370
Epoch: [29][6400/429]	total_loss:0.031  loss_aug:0.018    loss_pro:13.517
Epoch = 29,  current_test_acc=82.637, best_test_acc = 84.599
Epoch: [30][6500/429]	total_loss:0.034  loss_aug:0.014    loss_pro:20.499
Epoch: [30][6600/429]	total_loss:0.014  loss_aug:0.009    loss_pro:5.054
Epoch = 30,  current_test_acc=82.807, best_test_acc = 84.599
Epoch: [31][6700/429]	total_loss:0.024  loss_aug:0.009    loss_pro:15.340
Epoch: [31][6800/429]	total_loss:0.048  loss_aug:0.020    loss_pro:27.708
Epoch = 31,  current_test_acc=82.679, best_test_acc = 84.599
Epoch: [32][6900/429]	total_loss:0.042  loss_aug:0.016    loss_pro:26.310
Epoch: [32][7000/429]	total_loss:0.035  loss_aug:0.017    loss_pro:18.166
Epoch = 32,  current_test_acc=81.741, best_test_acc = 84.599
Epoch: [33][7100/429]	total_loss:0.052  loss_aug:0.027    loss_pro:24.803
Epoch: [33][7200/429]	total_loss:0.025  loss_aug:0.010    loss_pro:15.060
Epoch = 33,  current_test_acc=82.253, best_test_acc = 84.599
Epoch: [34][7300/429]	total_loss:0.033  loss_aug:0.014    loss_pro:19.079
Epoch: [34][7400/429]	total_loss:0.031  loss_aug:0.017    loss_pro:13.754
Epoch = 34,  current_test_acc=81.698, best_test_acc = 84.599
Epoch: [35][7500/429]	total_loss:0.049  loss_aug:0.021    loss_pro:28.132
Epoch: [35][7600/429]	total_loss:0.019  loss_aug:0.010    loss_pro:8.848
Epoch: [35][7700/429]	total_loss:0.025  loss_aug:0.013    loss_pro:11.922
Epoch = 35,  current_test_acc=83.490, best_test_acc = 84.599
Epoch: [36][7800/429]	total_loss:0.037  loss_aug:0.017    loss_pro:20.690
Epoch: [36][7900/429]	total_loss:0.037  loss_aug:0.016    loss_pro:20.864
Epoch = 36,  current_test_acc=81.826, best_test_acc = 84.599
Epoch: [37][8000/429]	total_loss:0.027  loss_aug:0.012    loss_pro:14.553
Epoch: [37][8100/429]	total_loss:0.057  loss_aug:0.034    loss_pro:22.209
Epoch = 37,  current_test_acc=83.319, best_test_acc = 84.599
Epoch: [38][8200/429]	total_loss:0.030  loss_aug:0.013    loss_pro:17.278
Epoch: [38][8300/429]	total_loss:0.023  loss_aug:0.011    loss_pro:11.596
Epoch = 38,  current_test_acc=81.143, best_test_acc = 84.599
Epoch: [39][8400/429]	total_loss:0.033  loss_aug:0.016    loss_pro:17.240
Epoch: [39][8500/429]	total_loss:0.038  loss_aug:0.022    loss_pro:15.800
Epoch = 39,  current_test_acc=81.655, best_test_acc = 84.599
Epoch: [40][8600/429]	total_loss:0.045  loss_aug:0.026    loss_pro:18.575
Epoch: [40][8700/429]	total_loss:0.022  loss_aug:0.010    loss_pro:11.669
Epoch = 40,  current_test_acc=83.447, best_test_acc = 84.599
Epoch: [41][8800/429]	total_loss:0.018  loss_aug:0.009    loss_pro:8.248
Epoch: [41][8900/429]	total_loss:0.030  loss_aug:0.017    loss_pro:12.480
Epoch = 41,  current_test_acc=81.954, best_test_acc = 84.599
Epoch: [42][9000/429]	total_loss:0.033  loss_aug:0.020    loss_pro:12.864
Epoch: [42][9100/429]	total_loss:0.038  loss_aug:0.018    loss_pro:19.312
Epoch: [42][9200/429]	total_loss:0.040  loss_aug:0.018    loss_pro:21.612
Epoch = 42,  current_test_acc=81.527, best_test_acc = 84.599
Epoch: [43][9300/429]	total_loss:0.039  loss_aug:0.023    loss_pro:15.625
Epoch: [43][9400/429]	total_loss:0.042  loss_aug:0.019    loss_pro:23.285
Epoch = 43,  current_test_acc=83.916, best_test_acc = 84.599
Epoch: [44][9500/429]	total_loss:0.039  loss_aug:0.017    loss_pro:22.343
Epoch: [44][9600/429]	total_loss:0.034  loss_aug:0.016    loss_pro:17.547
Epoch = 44,  current_test_acc=81.826, best_test_acc = 84.599
Epoch: [45][9700/429]	total_loss:0.031  loss_aug:0.016    loss_pro:14.971
Epoch: [45][9800/429]	total_loss:0.035  loss_aug:0.021    loss_pro:14.049
Epoch = 45,  current_test_acc=80.759, best_test_acc = 84.599
Epoch: [46][9900/429]	total_loss:0.028  loss_aug:0.012    loss_pro:15.874
Epoch: [46][10000/429]	total_loss:0.039  loss_aug:0.020    loss_pro:19.277
Epoch = 46,  current_test_acc=81.527, best_test_acc = 84.599
Epoch: [47][10100/429]	total_loss:0.044  loss_aug:0.023    loss_pro:20.974
Epoch: [47][10200/429]	total_loss:0.041  loss_aug:0.022    loss_pro:19.303
Epoch = 47,  current_test_acc=81.271, best_test_acc = 84.599
Epoch: [48][10300/429]	total_loss:0.036  loss_aug:0.021    loss_pro:15.103
Epoch: [48][10400/429]	total_loss:0.019  loss_aug:0.009    loss_pro:9.289
Epoch = 48,  current_test_acc=83.063, best_test_acc = 84.599
Epoch: [49][10500/429]	total_loss:0.045  loss_aug:0.023    loss_pro:21.902
Epoch: [49][10600/429]	total_loss:0.034  loss_aug:0.019    loss_pro:14.343
Epoch: [49][10700/429]	total_loss:0.016  loss_aug:0.009    loss_pro:6.561
Epoch = 49,  current_test_acc=81.229, best_test_acc = 84.599

epoch_test_best: 25
acc_test_best: 84.599
