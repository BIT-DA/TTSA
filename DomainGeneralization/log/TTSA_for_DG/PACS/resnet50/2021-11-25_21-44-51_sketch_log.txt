file name: train_TTSA_noMI_lr
PTL.version = 7.2.0
torch.version = 1.7.0+cu110
torchvision.version = 0.8.1+cu110
arch = resnet50
batch_size = 32
data_dir = /data1/TL/data/PACS/kfold/
dset = PACS
target_domain = sketch
gpu = 1
output_dir = log/TTSA_for_DG/PACS/resnet50
epochs = 50
print_freq = 100
lr = 0.015
schdule_gamma = 1.0
decay_rate = 0.75
momentum = 0.9
weight_decay = 0.001
bottleneck_dim = 256
alpha = 0.1
lambda0 = 0.25
eta = 0.5
gamma = 0.001
beta = 0.1
seed = 0
Epoch: [00][100/340]	total_loss:0.228  loss_aug:0.145    loss_pro:82.382
Epoch = 00,  current_test_acc=64.800, best_test_acc = 64.800
Epoch: [01][200/340]	total_loss:0.158  loss_aug:0.100    loss_pro:57.725
Epoch: [01][300/340]	total_loss:0.100  loss_aug:0.031    loss_pro:69.074
Epoch = 01,  current_test_acc=67.167, best_test_acc = 67.167
Epoch: [02][400/340]	total_loss:0.055  loss_aug:0.009    loss_pro:46.036
Epoch: [02][500/340]	total_loss:0.107  loss_aug:0.060    loss_pro:47.119
Epoch = 02,  current_test_acc=70.196, best_test_acc = 70.196
Epoch: [03][600/340]	total_loss:0.085  loss_aug:0.031    loss_pro:53.993
Epoch = 03,  current_test_acc=71.825, best_test_acc = 71.825
Epoch: [04][700/340]	total_loss:0.057  loss_aug:0.014    loss_pro:42.547
Epoch: [04][800/340]	total_loss:0.036  loss_aug:0.007    loss_pro:28.819
Epoch = 04,  current_test_acc=70.425, best_test_acc = 71.825
Epoch: [05][900/340]	total_loss:0.045  loss_aug:0.012    loss_pro:32.619
Epoch: [05][1000/340]	total_loss:0.111  loss_aug:0.074    loss_pro:36.595
Epoch = 05,  current_test_acc=64.189, best_test_acc = 71.825
Epoch: [06][1100/340]	total_loss:0.110  loss_aug:0.081    loss_pro:28.575
Epoch = 06,  current_test_acc=72.512, best_test_acc = 72.512
Epoch: [07][1200/340]	total_loss:0.038  loss_aug:0.008    loss_pro:29.390
Epoch: [07][1300/340]	total_loss:0.052  loss_aug:0.013    loss_pro:39.641
Epoch = 07,  current_test_acc=73.785, best_test_acc = 73.785
Epoch: [08][1400/340]	total_loss:0.049  loss_aug:0.018    loss_pro:30.574
Epoch: [08][1500/340]	total_loss:0.030  loss_aug:0.007    loss_pro:23.149
Epoch = 08,  current_test_acc=71.672, best_test_acc = 73.785
Epoch: [09][1600/340]	total_loss:0.069  loss_aug:0.046    loss_pro:22.666
Epoch: [09][1700/340]	total_loss:0.031  loss_aug:0.008    loss_pro:23.420
Epoch = 09,  current_test_acc=72.487, best_test_acc = 73.785
Epoch: [10][1800/340]	total_loss:0.040  loss_aug:0.010    loss_pro:29.827
Epoch = 10,  current_test_acc=73.021, best_test_acc = 73.785
Epoch: [11][1900/340]	total_loss:0.022  loss_aug:0.007    loss_pro:15.012
Epoch: [11][2000/340]	total_loss:0.022  loss_aug:0.005    loss_pro:17.751
Epoch = 11,  current_test_acc=70.552, best_test_acc = 73.785
Epoch: [12][2100/340]	total_loss:0.035  loss_aug:0.010    loss_pro:24.921
Epoch: [12][2200/340]	total_loss:0.050  loss_aug:0.018    loss_pro:31.258
Epoch = 12,  current_test_acc=73.352, best_test_acc = 73.785
Epoch: [13][2300/340]	total_loss:0.057  loss_aug:0.030    loss_pro:26.784
Epoch = 13,  current_test_acc=73.683, best_test_acc = 73.785
Epoch: [14][2400/340]	total_loss:0.041  loss_aug:0.015    loss_pro:25.992
Epoch: [14][2500/340]	total_loss:0.046  loss_aug:0.022    loss_pro:23.520
Epoch = 14,  current_test_acc=72.436, best_test_acc = 73.785
Epoch: [15][2600/340]	total_loss:0.021  loss_aug:0.007    loss_pro:13.677
Epoch: [15][2700/340]	total_loss:0.010  loss_aug:0.004    loss_pro:6.237
Epoch = 15,  current_test_acc=76.330, best_test_acc = 76.330
Epoch: [16][2800/340]	total_loss:0.032  loss_aug:0.008    loss_pro:23.173
Epoch = 16,  current_test_acc=74.421, best_test_acc = 76.330
Epoch: [17][2900/340]	total_loss:0.059  loss_aug:0.035    loss_pro:24.535
Epoch: [17][3000/340]	total_loss:0.041  loss_aug:0.030    loss_pro:10.940
Epoch = 17,  current_test_acc=74.574, best_test_acc = 76.330
Epoch: [18][3100/340]	total_loss:0.017  loss_aug:0.007    loss_pro:10.373
Epoch: [18][3200/340]	total_loss:0.036  loss_aug:0.024    loss_pro:11.901
Epoch = 18,  current_test_acc=73.581, best_test_acc = 76.330
Epoch: [19][3300/340]	total_loss:0.028  loss_aug:0.008    loss_pro:19.841
Epoch: [19][3400/340]	total_loss:0.030  loss_aug:0.010    loss_pro:20.857
Epoch = 19,  current_test_acc=74.039, best_test_acc = 76.330
Epoch: [20][3500/340]	total_loss:0.027  loss_aug:0.011    loss_pro:15.191
Epoch = 20,  current_test_acc=75.337, best_test_acc = 76.330
Epoch: [21][3600/340]	total_loss:0.016  loss_aug:0.007    loss_pro:8.573
Epoch: [21][3700/340]	total_loss:0.034  loss_aug:0.012    loss_pro:22.185
Epoch = 21,  current_test_acc=74.930, best_test_acc = 76.330
Epoch: [22][3800/340]	total_loss:0.021  loss_aug:0.011    loss_pro:10.601
Epoch: [22][3900/340]	total_loss:0.031  loss_aug:0.010    loss_pro:20.943
Epoch = 22,  current_test_acc=75.974, best_test_acc = 76.330
Epoch: [23][4000/340]	total_loss:0.037  loss_aug:0.017    loss_pro:20.004
Epoch = 23,  current_test_acc=74.905, best_test_acc = 76.330
Epoch: [24][4100/340]	total_loss:0.036  loss_aug:0.015    loss_pro:21.081
Epoch: [24][4200/340]	total_loss:0.033  loss_aug:0.018    loss_pro:15.236
Epoch = 24,  current_test_acc=75.185, best_test_acc = 76.330
Epoch: [25][4300/340]	total_loss:0.027  loss_aug:0.009    loss_pro:17.968
Epoch: [25][4400/340]	total_loss:0.037  loss_aug:0.020    loss_pro:16.326
Epoch = 25,  current_test_acc=73.683, best_test_acc = 76.330
Epoch: [26][4500/340]	total_loss:0.027  loss_aug:0.012    loss_pro:15.350
Epoch = 26,  current_test_acc=73.886, best_test_acc = 76.330
Epoch: [27][4600/340]	total_loss:0.032  loss_aug:0.011    loss_pro:21.106
Epoch: [27][4700/340]	total_loss:0.031  loss_aug:0.017    loss_pro:14.460
Epoch = 27,  current_test_acc=74.981, best_test_acc = 76.330
Epoch: [28][4800/340]	total_loss:0.031  loss_aug:0.014    loss_pro:16.340
Epoch: [28][4900/340]	total_loss:0.022  loss_aug:0.008    loss_pro:14.341
Epoch = 28,  current_test_acc=74.345, best_test_acc = 76.330
Epoch: [29][5000/340]	total_loss:0.025  loss_aug:0.009    loss_pro:15.420
Epoch: [29][5100/340]	total_loss:0.026  loss_aug:0.009    loss_pro:17.120
Epoch = 29,  current_test_acc=76.024, best_test_acc = 76.330
Epoch: [30][5200/340]	total_loss:0.026  loss_aug:0.013    loss_pro:13.420
Epoch = 30,  current_test_acc=73.963, best_test_acc = 76.330
Epoch: [31][5300/340]	total_loss:0.026  loss_aug:0.011    loss_pro:14.870
Epoch: [31][5400/340]	total_loss:0.034  loss_aug:0.017    loss_pro:16.781
Epoch = 31,  current_test_acc=77.195, best_test_acc = 77.195
Epoch: [32][5500/340]	total_loss:0.022  loss_aug:0.011    loss_pro:11.118
Epoch: [32][5600/340]	total_loss:0.025  loss_aug:0.011    loss_pro:13.842
Epoch = 32,  current_test_acc=73.479, best_test_acc = 77.195
Epoch: [33][5700/340]	total_loss:0.035  loss_aug:0.015    loss_pro:19.490
Epoch = 33,  current_test_acc=74.726, best_test_acc = 77.195
Epoch: [34][5800/340]	total_loss:0.024  loss_aug:0.015    loss_pro:8.875
Epoch: [34][5900/340]	total_loss:0.013  loss_aug:0.007    loss_pro:6.752
Epoch = 34,  current_test_acc=73.632, best_test_acc = 77.195
Epoch: [35][6000/340]	total_loss:0.058  loss_aug:0.048    loss_pro:10.174
Epoch: [35][6100/340]	total_loss:0.023  loss_aug:0.014    loss_pro:9.448
Epoch = 35,  current_test_acc=75.159, best_test_acc = 77.195
Epoch: [36][6200/340]	total_loss:0.022  loss_aug:0.015    loss_pro:7.226
Epoch = 36,  current_test_acc=74.141, best_test_acc = 77.195
Epoch: [37][6300/340]	total_loss:0.044  loss_aug:0.020    loss_pro:23.464
Epoch: [37][6400/340]	total_loss:0.020  loss_aug:0.011    loss_pro:9.232
Epoch = 37,  current_test_acc=75.337, best_test_acc = 77.195
Epoch: [38][6500/340]	total_loss:0.028  loss_aug:0.017    loss_pro:10.547
Epoch: [38][6600/340]	total_loss:0.036  loss_aug:0.018    loss_pro:17.181
Epoch = 38,  current_test_acc=75.490, best_test_acc = 77.195
Epoch: [39][6700/340]	total_loss:0.021  loss_aug:0.011    loss_pro:9.643
Epoch: [39][6800/340]	total_loss:0.025  loss_aug:0.013    loss_pro:12.016
Epoch = 39,  current_test_acc=74.446, best_test_acc = 77.195
Epoch: [40][6900/340]	total_loss:0.028  loss_aug:0.014    loss_pro:14.022
Epoch = 40,  current_test_acc=75.032, best_test_acc = 77.195
Epoch: [41][7000/340]	total_loss:0.023  loss_aug:0.011    loss_pro:12.179
Epoch: [41][7100/340]	total_loss:0.027  loss_aug:0.018    loss_pro:9.299
Epoch = 41,  current_test_acc=77.577, best_test_acc = 77.577
Epoch: [42][7200/340]	total_loss:0.027  loss_aug:0.015    loss_pro:12.476
Epoch: [42][7300/340]	total_loss:0.029  loss_aug:0.016    loss_pro:12.908
Epoch = 42,  current_test_acc=74.625, best_test_acc = 77.577
Epoch: [43][7400/340]	total_loss:0.026  loss_aug:0.012    loss_pro:14.316
Epoch = 43,  current_test_acc=75.719, best_test_acc = 77.577
Epoch: [44][7500/340]	total_loss:0.027  loss_aug:0.013    loss_pro:13.588
Epoch: [44][7600/340]	total_loss:0.025  loss_aug:0.012    loss_pro:12.315
Epoch = 44,  current_test_acc=75.108, best_test_acc = 77.577
Epoch: [45][7700/340]	total_loss:0.026  loss_aug:0.014    loss_pro:11.525
Epoch: [45][7800/340]	total_loss:0.031  loss_aug:0.016    loss_pro:15.695
Epoch = 45,  current_test_acc=77.781, best_test_acc = 77.781
Epoch: [46][7900/340]	total_loss:0.009  loss_aug:0.007    loss_pro:1.607
Epoch = 46,  current_test_acc=75.923, best_test_acc = 77.781
Epoch: [47][8000/340]	total_loss:0.035  loss_aug:0.019    loss_pro:16.397
Epoch: [47][8100/340]	total_loss:0.019  loss_aug:0.011    loss_pro:8.931
Epoch = 47,  current_test_acc=76.406, best_test_acc = 77.781
Epoch: [48][8200/340]	total_loss:0.028  loss_aug:0.016    loss_pro:11.411
Epoch: [48][8300/340]	total_loss:0.020  loss_aug:0.011    loss_pro:8.400
Epoch = 48,  current_test_acc=76.508, best_test_acc = 77.781
Epoch: [49][8400/340]	total_loss:0.041  loss_aug:0.024    loss_pro:16.447
Epoch: [49][8500/340]	total_loss:0.030  loss_aug:0.017    loss_pro:13.028
Epoch = 49,  current_test_acc=75.592, best_test_acc = 77.781

epoch_test_best: 45
acc_test_best: 77.781
