file name: train_TTSA_noMI_lr
PTL.version = 7.2.0
torch.version = 1.7.0+cu110
torchvision.version = 0.8.1+cu110
arch = resnet50
batch_size = 32
data_dir = /data1/TL/data/PACS/kfold/
dset = PACS
target_domain = photo
gpu = 1
output_dir = log/TTSA_for_DG/PACS/resnet50
epochs = 50
print_freq = 100
lr = 0.015
schdule_gamma = 1.0
decay_rate = 0.75
momentum = 0.9
weight_decay = 0.001
bottleneck_dim = 256
alpha = 0.1
lambda0 = 0.25
eta = 0.5
gamma = 0.001
beta = 0.1
seed = 0
Epoch: [00][100/467]	total_loss:0.808  loss_aug:0.713    loss_pro:94.476
Epoch: [00][200/467]	total_loss:0.753  loss_aug:0.682    loss_pro:70.898
Epoch = 00,  current_test_acc=95.988, best_test_acc = 95.988
Epoch: [01][300/467]	total_loss:0.129  loss_aug:0.059    loss_pro:69.981
Epoch: [01][400/467]	total_loss:0.204  loss_aug:0.129    loss_pro:75.773
Epoch = 01,  current_test_acc=94.311, best_test_acc = 95.988
Epoch: [02][500/467]	total_loss:0.190  loss_aug:0.139    loss_pro:51.026
Epoch: [02][600/467]	total_loss:0.300  loss_aug:0.243    loss_pro:56.362
Epoch = 02,  current_test_acc=95.868, best_test_acc = 95.988
Epoch: [03][700/467]	total_loss:0.116  loss_aug:0.062    loss_pro:54.279
Epoch: [03][800/467]	total_loss:0.085  loss_aug:0.042    loss_pro:43.514
Epoch: [03][900/467]	total_loss:0.335  loss_aug:0.293    loss_pro:41.834
Epoch = 03,  current_test_acc=93.353, best_test_acc = 95.988
Epoch: [04][1000/467]	total_loss:0.433  loss_aug:0.396    loss_pro:36.492
Epoch: [04][1100/467]	total_loss:0.082  loss_aug:0.050    loss_pro:32.618
Epoch = 04,  current_test_acc=95.329, best_test_acc = 95.988
Epoch: [05][1200/467]	total_loss:0.095  loss_aug:0.056    loss_pro:38.700
Epoch: [05][1300/467]	total_loss:0.060  loss_aug:0.027    loss_pro:33.513
Epoch = 05,  current_test_acc=94.132, best_test_acc = 95.988
Epoch: [06][1400/467]	total_loss:0.087  loss_aug:0.051    loss_pro:36.061
Epoch: [06][1500/467]	total_loss:0.162  loss_aug:0.128    loss_pro:33.258
Epoch: [06][1600/467]	total_loss:0.052  loss_aug:0.011    loss_pro:40.880
Epoch = 06,  current_test_acc=95.269, best_test_acc = 95.988
Epoch: [07][1700/467]	total_loss:0.132  loss_aug:0.100    loss_pro:31.406
Epoch: [07][1800/467]	total_loss:0.030  loss_aug:0.008    loss_pro:22.201
Epoch = 07,  current_test_acc=96.707, best_test_acc = 96.707
Epoch: [08][1900/467]	total_loss:0.056  loss_aug:0.016    loss_pro:39.805
Epoch: [08][2000/467]	total_loss:0.131  loss_aug:0.091    loss_pro:39.833
Epoch = 08,  current_test_acc=96.168, best_test_acc = 96.707
Epoch: [09][2100/467]	total_loss:0.062  loss_aug:0.039    loss_pro:23.057
Epoch: [09][2200/467]	total_loss:0.049  loss_aug:0.015    loss_pro:33.821
Epoch: [09][2300/467]	total_loss:0.057  loss_aug:0.035    loss_pro:21.873
Epoch = 09,  current_test_acc=96.347, best_test_acc = 96.707
Epoch: [10][2400/467]	total_loss:0.134  loss_aug:0.096    loss_pro:38.086
Epoch: [10][2500/467]	total_loss:0.102  loss_aug:0.071    loss_pro:30.640
Epoch = 10,  current_test_acc=95.389, best_test_acc = 96.707
Epoch: [11][2600/467]	total_loss:0.064  loss_aug:0.035    loss_pro:28.846
Epoch: [11][2700/467]	total_loss:0.055  loss_aug:0.022    loss_pro:32.647
Epoch = 11,  current_test_acc=97.006, best_test_acc = 97.006
Epoch: [12][2800/467]	total_loss:0.063  loss_aug:0.037    loss_pro:26.395
Epoch: [12][2900/467]	total_loss:0.060  loss_aug:0.037    loss_pro:22.946
Epoch: [12][3000/467]	total_loss:0.042  loss_aug:0.014    loss_pro:28.517
Epoch = 12,  current_test_acc=96.347, best_test_acc = 97.006
Epoch: [13][3100/467]	total_loss:0.039  loss_aug:0.016    loss_pro:23.727
Epoch: [13][3200/467]	total_loss:0.042  loss_aug:0.014    loss_pro:27.664
Epoch = 13,  current_test_acc=96.946, best_test_acc = 97.006
Epoch: [14][3300/467]	total_loss:0.069  loss_aug:0.049    loss_pro:19.521
Epoch: [14][3400/467]	total_loss:0.052  loss_aug:0.026    loss_pro:25.583
Epoch = 14,  current_test_acc=96.168, best_test_acc = 97.006
Epoch: [15][3500/467]	total_loss:0.042  loss_aug:0.015    loss_pro:27.605
Epoch: [15][3600/467]	total_loss:0.077  loss_aug:0.044    loss_pro:33.292
Epoch: [15][3700/467]	total_loss:0.038  loss_aug:0.020    loss_pro:18.537
Epoch = 15,  current_test_acc=96.228, best_test_acc = 97.006
Epoch: [16][3800/467]	total_loss:0.025  loss_aug:0.009    loss_pro:15.599
Epoch: [16][3900/467]	total_loss:0.039  loss_aug:0.013    loss_pro:26.303
Epoch = 16,  current_test_acc=96.766, best_test_acc = 97.006
Epoch: [17][4000/467]	total_loss:0.045  loss_aug:0.022    loss_pro:23.037
Epoch: [17][4100/467]	total_loss:0.052  loss_aug:0.030    loss_pro:21.987
Epoch = 17,  current_test_acc=96.826, best_test_acc = 97.006
Epoch: [18][4200/467]	total_loss:0.035  loss_aug:0.013    loss_pro:22.092
Epoch: [18][4300/467]	total_loss:0.025  loss_aug:0.016    loss_pro:8.966
Epoch: [18][4400/467]	total_loss:0.025  loss_aug:0.011    loss_pro:14.042
Epoch = 18,  current_test_acc=96.826, best_test_acc = 97.006
Epoch: [19][4500/467]	total_loss:0.044  loss_aug:0.029    loss_pro:14.784
Epoch: [19][4600/467]	total_loss:0.036  loss_aug:0.017    loss_pro:18.905
Epoch = 19,  current_test_acc=97.186, best_test_acc = 97.186
Epoch: [20][4700/467]	total_loss:0.026  loss_aug:0.014    loss_pro:12.044
Epoch: [20][4800/467]	total_loss:0.037  loss_aug:0.013    loss_pro:24.521
Epoch = 20,  current_test_acc=96.467, best_test_acc = 97.186
Epoch: [21][4900/467]	total_loss:0.042  loss_aug:0.015    loss_pro:26.497
Epoch: [21][5000/467]	total_loss:0.051  loss_aug:0.033    loss_pro:18.752
Epoch: [21][5100/467]	total_loss:0.044  loss_aug:0.024    loss_pro:20.517
Epoch = 21,  current_test_acc=96.287, best_test_acc = 97.186
Epoch: [22][5200/467]	total_loss:0.074  loss_aug:0.038    loss_pro:36.097
Epoch: [22][5300/467]	total_loss:0.038  loss_aug:0.018    loss_pro:19.722
Epoch = 22,  current_test_acc=97.066, best_test_acc = 97.186
Epoch: [23][5400/467]	total_loss:0.020  loss_aug:0.009    loss_pro:11.523
Epoch: [23][5500/467]	total_loss:0.028  loss_aug:0.012    loss_pro:16.307
Epoch = 23,  current_test_acc=97.006, best_test_acc = 97.186
Epoch: [24][5600/467]	total_loss:0.043  loss_aug:0.018    loss_pro:25.337
Epoch: [24][5700/467]	total_loss:0.032  loss_aug:0.014    loss_pro:18.651
Epoch: [24][5800/467]	total_loss:0.048  loss_aug:0.024    loss_pro:23.149
Epoch = 24,  current_test_acc=96.407, best_test_acc = 97.186
Epoch: [25][5900/467]	total_loss:0.027  loss_aug:0.014    loss_pro:12.512
Epoch: [25][6000/467]	total_loss:0.020  loss_aug:0.010    loss_pro:9.960
Epoch = 25,  current_test_acc=96.347, best_test_acc = 97.186
Epoch: [26][6100/467]	total_loss:0.043  loss_aug:0.031    loss_pro:12.092
Epoch: [26][6200/467]	total_loss:0.029  loss_aug:0.012    loss_pro:17.411
Epoch = 26,  current_test_acc=96.287, best_test_acc = 97.186
Epoch: [27][6300/467]	total_loss:0.034  loss_aug:0.017    loss_pro:17.456
Epoch: [27][6400/467]	total_loss:0.073  loss_aug:0.053    loss_pro:19.626
Epoch: [27][6500/467]	total_loss:0.105  loss_aug:0.095    loss_pro:9.561
Epoch = 27,  current_test_acc=96.886, best_test_acc = 97.186
Epoch: [28][6600/467]	total_loss:0.031  loss_aug:0.014    loss_pro:17.814
Epoch: [28][6700/467]	total_loss:0.041  loss_aug:0.019    loss_pro:22.095
Epoch = 28,  current_test_acc=96.228, best_test_acc = 97.186
Epoch: [29][6800/467]	total_loss:0.030  loss_aug:0.016    loss_pro:13.798
Epoch: [29][6900/467]	total_loss:0.028  loss_aug:0.015    loss_pro:13.081
Epoch = 29,  current_test_acc=96.707, best_test_acc = 97.186
Epoch: [30][7000/467]	total_loss:0.038  loss_aug:0.024    loss_pro:13.841
Epoch: [30][7100/467]	total_loss:0.031  loss_aug:0.019    loss_pro:11.754
Epoch: [30][7200/467]	total_loss:0.021  loss_aug:0.013    loss_pro:7.677
Epoch = 30,  current_test_acc=96.886, best_test_acc = 97.186
Epoch: [31][7300/467]	total_loss:0.028  loss_aug:0.014    loss_pro:14.161
Epoch: [31][7400/467]	total_loss:0.040  loss_aug:0.021    loss_pro:18.643
Epoch = 31,  current_test_acc=97.126, best_test_acc = 97.186
Epoch: [32][7500/467]	total_loss:0.037  loss_aug:0.015    loss_pro:21.461
Epoch: [32][7600/467]	total_loss:0.015  loss_aug:0.009    loss_pro:6.916
Epoch = 32,  current_test_acc=97.006, best_test_acc = 97.186
Epoch: [33][7700/467]	total_loss:0.047  loss_aug:0.023    loss_pro:24.713
Epoch: [33][7800/467]	total_loss:0.019  loss_aug:0.010    loss_pro:8.887
Epoch: [33][7900/467]	total_loss:0.030  loss_aug:0.013    loss_pro:17.122
Epoch = 33,  current_test_acc=96.886, best_test_acc = 97.186
Epoch: [34][8000/467]	total_loss:0.030  loss_aug:0.016    loss_pro:13.949
Epoch: [34][8100/467]	total_loss:0.028  loss_aug:0.013    loss_pro:15.595
Epoch = 34,  current_test_acc=96.766, best_test_acc = 97.186
Epoch: [35][8200/467]	total_loss:0.045  loss_aug:0.031    loss_pro:14.207
Epoch: [35][8300/467]	total_loss:0.021  loss_aug:0.009    loss_pro:11.670
Epoch = 35,  current_test_acc=96.527, best_test_acc = 97.186
Epoch: [36][8400/467]	total_loss:0.037  loss_aug:0.017    loss_pro:20.655
Epoch: [36][8500/467]	total_loss:0.027  loss_aug:0.017    loss_pro:10.099
Epoch: [36][8600/467]	total_loss:0.031  loss_aug:0.013    loss_pro:17.804
Epoch = 36,  current_test_acc=96.766, best_test_acc = 97.186
Epoch: [37][8700/467]	total_loss:0.043  loss_aug:0.022    loss_pro:20.647
Epoch: [37][8800/467]	total_loss:0.027  loss_aug:0.014    loss_pro:12.775
Epoch = 37,  current_test_acc=96.707, best_test_acc = 97.186
Epoch: [38][8900/467]	total_loss:0.043  loss_aug:0.021    loss_pro:22.297
Epoch: [38][9000/467]	total_loss:0.022  loss_aug:0.013    loss_pro:9.394
Epoch = 38,  current_test_acc=97.066, best_test_acc = 97.186
Epoch: [39][9100/467]	total_loss:0.025  loss_aug:0.012    loss_pro:13.102
Epoch: [39][9200/467]	total_loss:0.036  loss_aug:0.015    loss_pro:20.340
Epoch: [39][9300/467]	total_loss:0.043  loss_aug:0.027    loss_pro:16.289
Epoch = 39,  current_test_acc=96.886, best_test_acc = 97.186
Epoch: [40][9400/467]	total_loss:0.037  loss_aug:0.018    loss_pro:19.286
Epoch: [40][9500/467]	total_loss:0.036  loss_aug:0.019    loss_pro:16.209
Epoch = 40,  current_test_acc=96.826, best_test_acc = 97.186
Epoch: [41][9600/467]	total_loss:0.022  loss_aug:0.012    loss_pro:10.461
Epoch: [41][9700/467]	total_loss:0.024  loss_aug:0.012    loss_pro:11.793
Epoch = 41,  current_test_acc=97.186, best_test_acc = 97.186
Epoch: [42][9800/467]	total_loss:0.016  loss_aug:0.008    loss_pro:7.779
Epoch: [42][9900/467]	total_loss:0.026  loss_aug:0.014    loss_pro:12.811
Epoch: [42][10000/467]	total_loss:0.030  loss_aug:0.016    loss_pro:14.029
Epoch = 42,  current_test_acc=97.066, best_test_acc = 97.186
Epoch: [43][10100/467]	total_loss:0.027  loss_aug:0.012    loss_pro:15.506
Epoch: [43][10200/467]	total_loss:0.035  loss_aug:0.019    loss_pro:16.168
Epoch = 43,  current_test_acc=97.126, best_test_acc = 97.186
Epoch: [44][10300/467]	total_loss:0.056  loss_aug:0.040    loss_pro:15.528
Epoch: [44][10400/467]	total_loss:0.047  loss_aug:0.023    loss_pro:24.346
Epoch = 44,  current_test_acc=96.647, best_test_acc = 97.186
Epoch: [45][10500/467]	total_loss:0.017  loss_aug:0.009    loss_pro:8.022
Epoch: [45][10600/467]	total_loss:0.066  loss_aug:0.041    loss_pro:24.814
Epoch: [45][10700/467]	total_loss:0.020  loss_aug:0.010    loss_pro:9.978
Epoch = 45,  current_test_acc=96.647, best_test_acc = 97.186
Epoch: [46][10800/467]	total_loss:0.039  loss_aug:0.018    loss_pro:21.130
Epoch: [46][10900/467]	total_loss:0.043  loss_aug:0.023    loss_pro:19.796
Epoch = 46,  current_test_acc=97.246, best_test_acc = 97.246
Epoch: [47][11000/467]	total_loss:0.029  loss_aug:0.012    loss_pro:16.635
Epoch: [47][11100/467]	total_loss:0.032  loss_aug:0.016    loss_pro:16.059
Epoch = 47,  current_test_acc=96.826, best_test_acc = 97.246
Epoch: [48][11200/467]	total_loss:0.026  loss_aug:0.014    loss_pro:12.193
Epoch: [48][11300/467]	total_loss:0.040  loss_aug:0.018    loss_pro:21.939
Epoch: [48][11400/467]	total_loss:0.029  loss_aug:0.017    loss_pro:12.199
Epoch = 48,  current_test_acc=96.826, best_test_acc = 97.246
Epoch: [49][11500/467]	total_loss:0.024  loss_aug:0.011    loss_pro:13.193
Epoch: [49][11600/467]	total_loss:0.042  loss_aug:0.024    loss_pro:17.853
Epoch = 49,  current_test_acc=96.946, best_test_acc = 97.246

epoch_test_best: 46
acc_test_best: 97.246
