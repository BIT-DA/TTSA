file name: train_TTSA_noMI_lr
PTL.version = 7.2.0
torch.version = 1.7.0+cu110
torchvision.version = 0.8.1+cu110
arch = resnet18
batch_size = 32
data_dir = /data1/TL/data/PACS/kfold/
dset = PACS
target_domain = art_painting
gpu = 6
output_dir = log/TTSA_for_DG/PACS/resnet18
epochs = 50
print_freq = 100
lr = 0.025
schdule_gamma = 1.0
decay_rate = 0.75
momentum = 0.9
weight_decay = 0.001
bottleneck_dim = 256
alpha = 0.1
lambda0 = 0.25
eta = 0.5
gamma = 0.001
beta = 0.1
seed = 0
Epoch: [00][100/446]	total_loss:0.280  loss_aug:0.196    loss_pro:84.955
Epoch: [00][200/446]	total_loss:0.426  loss_aug:0.348    loss_pro:77.591
Epoch = 00,  current_test_acc=78.076, best_test_acc = 78.076
Epoch: [01][300/446]	total_loss:0.307  loss_aug:0.253    loss_pro:54.424
Epoch: [01][400/446]	total_loss:0.312  loss_aug:0.252    loss_pro:59.875
Epoch = 01,  current_test_acc=77.148, best_test_acc = 78.076
Epoch: [02][500/446]	total_loss:0.072  loss_aug:0.022    loss_pro:50.014
Epoch: [02][600/446]	total_loss:0.203  loss_aug:0.146    loss_pro:56.373
Epoch = 02,  current_test_acc=72.998, best_test_acc = 78.076
Epoch: [03][700/446]	total_loss:0.212  loss_aug:0.163    loss_pro:49.694
Epoch: [03][800/446]	total_loss:0.073  loss_aug:0.031    loss_pro:42.003
Epoch = 03,  current_test_acc=74.805, best_test_acc = 78.076
Epoch: [04][900/446]	total_loss:0.068  loss_aug:0.034    loss_pro:33.529
Epoch: [04][1000/446]	total_loss:0.072  loss_aug:0.038    loss_pro:33.953
Epoch: [04][1100/446]	total_loss:0.131  loss_aug:0.096    loss_pro:34.822
Epoch = 04,  current_test_acc=76.025, best_test_acc = 78.076
Epoch: [05][1200/446]	total_loss:0.062  loss_aug:0.019    loss_pro:43.101
Epoch: [05][1300/446]	total_loss:0.091  loss_aug:0.059    loss_pro:32.243
Epoch = 05,  current_test_acc=75.635, best_test_acc = 78.076
Epoch: [06][1400/446]	total_loss:0.091  loss_aug:0.049    loss_pro:41.684
Epoch: [06][1500/446]	total_loss:0.269  loss_aug:0.233    loss_pro:35.900
Epoch = 06,  current_test_acc=78.223, best_test_acc = 78.223
Epoch: [07][1600/446]	total_loss:0.047  loss_aug:0.020    loss_pro:27.034
Epoch: [07][1700/446]	total_loss:0.148  loss_aug:0.124    loss_pro:24.377
Epoch = 07,  current_test_acc=77.686, best_test_acc = 78.223
Epoch: [08][1800/446]	total_loss:0.052  loss_aug:0.028    loss_pro:23.726
Epoch: [08][1900/446]	total_loss:0.046  loss_aug:0.016    loss_pro:30.331
Epoch: [08][2000/446]	total_loss:0.070  loss_aug:0.037    loss_pro:32.129
Epoch = 08,  current_test_acc=75.830, best_test_acc = 78.223
Epoch: [09][2100/446]	total_loss:0.089  loss_aug:0.064    loss_pro:24.751
Epoch: [09][2200/446]	total_loss:0.052  loss_aug:0.021    loss_pro:30.496
Epoch = 09,  current_test_acc=80.566, best_test_acc = 80.566
Epoch: [10][2300/446]	total_loss:0.036  loss_aug:0.011    loss_pro:25.125
Epoch: [10][2400/446]	total_loss:0.034  loss_aug:0.012    loss_pro:22.083
Epoch = 10,  current_test_acc=78.760, best_test_acc = 80.566
Epoch: [11][2500/446]	total_loss:0.037  loss_aug:0.019    loss_pro:17.721
Epoch: [11][2600/446]	total_loss:0.166  loss_aug:0.140    loss_pro:25.924
Epoch = 11,  current_test_acc=81.104, best_test_acc = 81.104
Epoch: [12][2700/446]	total_loss:0.033  loss_aug:0.014    loss_pro:18.655
Epoch: [12][2800/446]	total_loss:0.046  loss_aug:0.033    loss_pro:13.049
Epoch = 12,  current_test_acc=81.836, best_test_acc = 81.836
Epoch: [13][2900/446]	total_loss:0.047  loss_aug:0.020    loss_pro:26.699
Epoch: [13][3000/446]	total_loss:0.108  loss_aug:0.081    loss_pro:27.022
Epoch: [13][3100/446]	total_loss:0.033  loss_aug:0.011    loss_pro:22.085
Epoch = 13,  current_test_acc=81.738, best_test_acc = 81.836
Epoch: [14][3200/446]	total_loss:0.066  loss_aug:0.043    loss_pro:22.563
Epoch: [14][3300/446]	total_loss:0.033  loss_aug:0.014    loss_pro:18.858
Epoch = 14,  current_test_acc=78.174, best_test_acc = 81.836
Epoch: [15][3400/446]	total_loss:0.073  loss_aug:0.046    loss_pro:26.511
Epoch: [15][3500/446]	total_loss:0.046  loss_aug:0.022    loss_pro:24.711
Epoch = 15,  current_test_acc=81.982, best_test_acc = 81.982
Epoch: [16][3600/446]	total_loss:0.029  loss_aug:0.013    loss_pro:15.807
Epoch: [16][3700/446]	total_loss:0.043  loss_aug:0.024    loss_pro:18.704
Epoch = 16,  current_test_acc=81.250, best_test_acc = 81.982
Epoch: [17][3800/446]	total_loss:0.104  loss_aug:0.079    loss_pro:24.909
Epoch: [17][3900/446]	total_loss:0.021  loss_aug:0.011    loss_pro:10.259
Epoch: [17][4000/446]	total_loss:0.033  loss_aug:0.016    loss_pro:16.977
Epoch = 17,  current_test_acc=80.029, best_test_acc = 81.982
Epoch: [18][4100/446]	total_loss:0.054  loss_aug:0.028    loss_pro:25.410
Epoch: [18][4200/446]	total_loss:0.034  loss_aug:0.022    loss_pro:12.547
Epoch = 18,  current_test_acc=80.908, best_test_acc = 81.982
Epoch: [19][4300/446]	total_loss:0.040  loss_aug:0.026    loss_pro:14.157
Epoch: [19][4400/446]	total_loss:0.060  loss_aug:0.045    loss_pro:14.946
Epoch = 19,  current_test_acc=80.420, best_test_acc = 81.982
Epoch: [20][4500/446]	total_loss:0.036  loss_aug:0.013    loss_pro:23.120
Epoch: [20][4600/446]	total_loss:0.038  loss_aug:0.024    loss_pro:14.268
Epoch = 20,  current_test_acc=82.812, best_test_acc = 82.812
Epoch: [21][4700/446]	total_loss:0.036  loss_aug:0.018    loss_pro:17.935
Epoch: [21][4800/446]	total_loss:0.029  loss_aug:0.013    loss_pro:16.204
Epoch: [21][4900/446]	total_loss:0.033  loss_aug:0.012    loss_pro:21.183
Epoch = 21,  current_test_acc=79.541, best_test_acc = 82.812
Epoch: [22][5000/446]	total_loss:0.032  loss_aug:0.016    loss_pro:16.213
Epoch: [22][5100/446]	total_loss:0.045  loss_aug:0.023    loss_pro:21.472
Epoch = 22,  current_test_acc=81.934, best_test_acc = 82.812
Epoch: [23][5200/446]	total_loss:0.037  loss_aug:0.017    loss_pro:20.599
Epoch: [23][5300/446]	total_loss:0.030  loss_aug:0.011    loss_pro:19.749
Epoch = 23,  current_test_acc=81.592, best_test_acc = 82.812
Epoch: [24][5400/446]	total_loss:0.023  loss_aug:0.009    loss_pro:13.956
Epoch: [24][5500/446]	total_loss:0.034  loss_aug:0.012    loss_pro:21.726
Epoch = 24,  current_test_acc=78.955, best_test_acc = 82.812
Epoch: [25][5600/446]	total_loss:0.023  loss_aug:0.013    loss_pro:10.078
Epoch: [25][5700/446]	total_loss:0.123  loss_aug:0.095    loss_pro:28.657
Epoch = 25,  current_test_acc=80.566, best_test_acc = 82.812
Epoch: [26][5800/446]	total_loss:0.034  loss_aug:0.017    loss_pro:16.912
Epoch: [26][5900/446]	total_loss:0.029  loss_aug:0.016    loss_pro:13.080
Epoch: [26][6000/446]	total_loss:0.033  loss_aug:0.017    loss_pro:15.599
Epoch = 26,  current_test_acc=80.811, best_test_acc = 82.812
Epoch: [27][6100/446]	total_loss:0.035  loss_aug:0.023    loss_pro:11.123
Epoch: [27][6200/446]	total_loss:0.028  loss_aug:0.017    loss_pro:10.841
Epoch = 27,  current_test_acc=80.615, best_test_acc = 82.812
Epoch: [28][6300/446]	total_loss:0.033  loss_aug:0.017    loss_pro:16.612
Epoch: [28][6400/446]	total_loss:0.023  loss_aug:0.010    loss_pro:13.181
Epoch = 28,  current_test_acc=82.568, best_test_acc = 82.812
Epoch: [29][6500/446]	total_loss:0.064  loss_aug:0.052    loss_pro:11.878
Epoch: [29][6600/446]	total_loss:0.028  loss_aug:0.011    loss_pro:17.154
Epoch = 29,  current_test_acc=81.299, best_test_acc = 82.812
Epoch: [30][6700/446]	total_loss:0.026  loss_aug:0.018    loss_pro:7.938
Epoch: [30][6800/446]	total_loss:0.022  loss_aug:0.011    loss_pro:10.595
Epoch: [30][6900/446]	total_loss:0.045  loss_aug:0.022    loss_pro:22.458
Epoch = 30,  current_test_acc=80.127, best_test_acc = 82.812
Epoch: [31][7000/446]	total_loss:0.050  loss_aug:0.030    loss_pro:20.081
Epoch: [31][7100/446]	total_loss:0.035  loss_aug:0.015    loss_pro:20.017
Epoch = 31,  current_test_acc=81.348, best_test_acc = 82.812
Epoch: [32][7200/446]	total_loss:0.030  loss_aug:0.017    loss_pro:12.423
Epoch: [32][7300/446]	total_loss:0.024  loss_aug:0.010    loss_pro:13.643
Epoch = 32,  current_test_acc=80.518, best_test_acc = 82.812
Epoch: [33][7400/446]	total_loss:0.028  loss_aug:0.016    loss_pro:11.988
Epoch: [33][7500/446]	total_loss:0.032  loss_aug:0.015    loss_pro:16.570
Epoch = 33,  current_test_acc=80.859, best_test_acc = 82.812
Epoch: [34][7600/446]	total_loss:0.025  loss_aug:0.012    loss_pro:12.678
Epoch: [34][7700/446]	total_loss:0.027  loss_aug:0.013    loss_pro:14.473
Epoch: [34][7800/446]	total_loss:0.042  loss_aug:0.024    loss_pro:17.696
Epoch = 34,  current_test_acc=81.787, best_test_acc = 82.812
Epoch: [35][7900/446]	total_loss:0.034  loss_aug:0.018    loss_pro:16.114
Epoch: [35][8000/446]	total_loss:0.056  loss_aug:0.041    loss_pro:15.325
Epoch = 35,  current_test_acc=81.494, best_test_acc = 82.812
Epoch: [36][8100/446]	total_loss:0.049  loss_aug:0.032    loss_pro:17.054
Epoch: [36][8200/446]	total_loss:0.030  loss_aug:0.020    loss_pro:9.122
Epoch = 36,  current_test_acc=81.787, best_test_acc = 82.812
Epoch: [37][8300/446]	total_loss:0.038  loss_aug:0.021    loss_pro:17.318
Epoch: [37][8400/446]	total_loss:0.019  loss_aug:0.009    loss_pro:10.047
Epoch = 37,  current_test_acc=81.592, best_test_acc = 82.812
Epoch: [38][8500/446]	total_loss:0.015  loss_aug:0.008    loss_pro:6.927
Epoch: [38][8600/446]	total_loss:0.062  loss_aug:0.039    loss_pro:22.603
Epoch = 38,  current_test_acc=80.322, best_test_acc = 82.812
Epoch: [39][8700/446]	total_loss:0.028  loss_aug:0.014    loss_pro:13.514
Epoch: [39][8800/446]	total_loss:0.034  loss_aug:0.016    loss_pro:18.033
Epoch: [39][8900/446]	total_loss:0.055  loss_aug:0.042    loss_pro:12.191
Epoch = 39,  current_test_acc=74.609, best_test_acc = 82.812
Epoch: [40][9000/446]	total_loss:0.057  loss_aug:0.038    loss_pro:19.550
Epoch: [40][9100/446]	total_loss:0.055  loss_aug:0.031    loss_pro:23.667
Epoch = 40,  current_test_acc=80.762, best_test_acc = 82.812
Epoch: [41][9200/446]	total_loss:0.018  loss_aug:0.009    loss_pro:8.959
Epoch: [41][9300/446]	total_loss:0.055  loss_aug:0.035    loss_pro:19.821
Epoch = 41,  current_test_acc=80.225, best_test_acc = 82.812
Epoch: [42][9400/446]	total_loss:0.035  loss_aug:0.014    loss_pro:20.489
Epoch: [42][9500/446]	total_loss:0.035  loss_aug:0.019    loss_pro:16.365
Epoch = 42,  current_test_acc=80.957, best_test_acc = 82.812
Epoch: [43][9600/446]	total_loss:0.044  loss_aug:0.021    loss_pro:23.020
Epoch: [43][9700/446]	total_loss:0.041  loss_aug:0.018    loss_pro:22.961
Epoch: [43][9800/446]	total_loss:0.031  loss_aug:0.018    loss_pro:13.194
Epoch = 43,  current_test_acc=81.982, best_test_acc = 82.812
Epoch: [44][9900/446]	total_loss:0.029  loss_aug:0.015    loss_pro:14.584
Epoch: [44][10000/446]	total_loss:0.040  loss_aug:0.018    loss_pro:21.312
Epoch = 44,  current_test_acc=80.273, best_test_acc = 82.812
Epoch: [45][10100/446]	total_loss:0.028  loss_aug:0.012    loss_pro:16.383
Epoch: [45][10200/446]	total_loss:0.026  loss_aug:0.016    loss_pro:10.900
Epoch = 45,  current_test_acc=81.152, best_test_acc = 82.812
Epoch: [46][10300/446]	total_loss:0.040  loss_aug:0.020    loss_pro:20.284
Epoch: [46][10400/446]	total_loss:0.028  loss_aug:0.016    loss_pro:12.035
Epoch = 46,  current_test_acc=80.859, best_test_acc = 82.812
Epoch: [47][10500/446]	total_loss:0.029  loss_aug:0.014    loss_pro:15.642
Epoch: [47][10600/446]	total_loss:0.023  loss_aug:0.011    loss_pro:11.990
Epoch: [47][10700/446]	total_loss:0.112  loss_aug:0.087    loss_pro:25.077
Epoch = 47,  current_test_acc=81.738, best_test_acc = 82.812
Epoch: [48][10800/446]	total_loss:0.051  loss_aug:0.035    loss_pro:16.576
Epoch: [48][10900/446]	total_loss:0.022  loss_aug:0.010    loss_pro:12.446
Epoch = 48,  current_test_acc=82.178, best_test_acc = 82.812
Epoch: [49][11000/446]	total_loss:0.027  loss_aug:0.015    loss_pro:12.570
Epoch: [49][11100/446]	total_loss:0.041  loss_aug:0.023    loss_pro:18.022
Epoch = 49,  current_test_acc=80.078, best_test_acc = 82.812

epoch_test_best: 20
acc_test_best: 82.812
